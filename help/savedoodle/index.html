<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="google-site-verification" content="fYVpSfxWCs2yqh6HrmIurwg_hof_7vkfSq2kB6yqVGQ"><meta name="description" content="Blazor Canvas Drawing Component"><meta name="keywords" content="blazor, blazor drawing, canvas, ui, doodle, stdoodle, .net 5, trevor marÃ©, stdoodle.doodle, draw, pen"><title>STDoodle Doodle</title><base href="/STDoodle/"><link href="css/bootstrap/bootstrap.min.css" rel="stylesheet"><link href="css/app.css" rel="stylesheet"><link href="STDoodle.DemoWASM.styles.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/github-dark.min.css"><style>.font-style-italic{font-style:italic}</style><link rel="preconnect" href="https://cdnjs.cloudflare.com"></head><body><div id="app"><!--!--><!--!--><!--!--><!--!--><div class="page" b-a02fw36nuz=""><div class="sidebar" b-a02fw36nuz=""><!--!--><div class="top-row pl-4 navbar navbar-dark" b-t71mygaqfq=""><!--!--><a class="navbar-brand" href="" b-t71mygaqfq="">STDoodle.DemoWASM</a> <button class="navbar-toggler" b-t71mygaqfq=""><!--!--><span class="navbar-toggler-icon" b-t71mygaqfq=""></span></button></div><!--!--><div class="collapse" b-t71mygaqfq=""><ul class="nav flex-column" b-t71mygaqfq=""><li class="nav-item px-3" b-t71mygaqfq=""><!--!--><a href="" class="nav-link active"><!--!--><span class="oi oi-plus" aria-hidden="true" b-t71mygaqfq=""></span> Overview</a></li><!--!--><li class="nav-item px-3" b-t71mygaqfq=""><!--!--><a href="help/doodledraw" class="nav-link"><!--!--><span class="oi oi-home" aria-hidden="true" b-t71mygaqfq=""></span> Demo</a></li><!--!--><li class="nav-item px-3" b-t71mygaqfq=""><!--!--><a href="help/configuration" class="nav-link"><!--!--><span class="oi oi-home" aria-hidden="true" b-t71mygaqfq=""></span> Configuration</a></li><!--!--><li class="nav-item px-3" b-t71mygaqfq=""><!--!--><a href="help/exportimage" class="nav-link"><!--!--><span class="oi oi-home" aria-hidden="true" b-t71mygaqfq=""></span> Export Image</a></li><!--!--><li class="nav-item px-3" b-t71mygaqfq=""><!--!--><a href="help/servicestartup" class="nav-link"><!--!--><span class="oi oi-home" aria-hidden="true" b-t71mygaqfq=""></span> Register Services</a></li><!--!--><li class="nav-item px-3" b-t71mygaqfq=""><!--!--><a href="help/savedoodle" class="nav-link active"><!--!--><span class="oi oi-home" aria-hidden="true" b-t71mygaqfq=""></span> Save/Restore Doodle</a></li><!--!--><li class="nav-item px-3" b-t71mygaqfq=""><!--!--><a href="help/theme" class="nav-link"><!--!--><span class="oi oi-home" aria-hidden="true" b-t71mygaqfq=""></span> Theme</a></li></ul></div></div><!--!--><div class="main" b-a02fw36nuz=""><!--!--><div class="top-row px-4" b-a02fw36nuz=""><a href="http://blazor.net" target="_blank" class="ml-md-auto" b-a02fw36nuz="">About</a></div><div class="content px-4" b-a02fw36nuz=""><!--!--><!--!--><!--!--><h2>Saving and Restoring a Doodle</h2><!--!--><p>Due to image degradation of exporting an image multiple times, this component allows for saving and restoring from a state. The state is kept in json format and can be persisted or restored when required.</p><!--!--><h3>Saving Doodle</h3><!--!--><h4>Component Call</h4><!--!--><p>The first way of saving a Doodle would be to call the save functionality on the reference of the Doodle object.</p><pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"height: 50vh;"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">DoodleDraw</span> @<span class="hljs-attr">ref</span>=<span class="hljs-string">"_doodleDraw"</span>&gt;</span>
        
    <span class="hljs-tag">&lt;/<span class="hljs-name">DoodleDraw</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><!--!--><pre><code class="language-cs hljs language-csharp">@code {
    <span class="hljs-keyword">private</span> DoodleDraw _doodleDraw;

    <span class="hljs-comment">// Called from a custom button click</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">OnSaveButtonClick</span>(<span class="hljs-params"></span>)</span> 
    {
        ...
        <span class="hljs-built_in">string</span> stateData = <span class="hljs-keyword">await</span> _doodleDraw.SaveCurrentDrawState();
        ...                
    }
}
    </code></pre><!--!--><!--!--><h4>Doodle Save Event Callback</h4><!--!--><p>The second way of saving a Doodle would be to set the callback event property on the Doodle.</p><pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"height: 50vh;"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">DoodleDraw</span> @<span class="hljs-attr">ref</span>=<span class="hljs-string">"_doodleDraw"</span> <span class="hljs-attr">OnSaveDoodle</span>=<span class="hljs-string">"SaveDoodle"</span>&gt;</span>
        
    <span class="hljs-tag">&lt;/<span class="hljs-name">DoodleDraw</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><!--!--><pre><code class="language-cs hljs language-csharp">@code {
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SaveDoodle</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> stateData</span>)</span> 
    {
        ...
    }
}
    </code></pre><!--!--><!--!--><h4>Save Doodle Handler</h4><!--!--><p>The last way of saving a Doodle would be to create a custom save Doodle handler. Below is an example of creating such a handler</p><pre><code class="language-cs hljs language-csharp">
       
    <span class="hljs-keyword">namespace</span> <span class="hljs-title">YourNamespace</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnSaveDoodleDrawHandler</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, <span class="hljs-built_in">string</span> jsonData</span>)</span>;

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MySaveHandler</span> : <span class="hljs-title">Abstractions.Interfaces.IDoodleSaveHandler</span>
        {
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> OnSaveDoodleDrawHandler OnSaveDoodleDraw;

            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-built_in">string</span>&gt; <span class="hljs-title">SaveDoodleDraw</span>(<span class="hljs-params">IDoodleDrawInteraction doodleDrawInteraction</span>)</span>
            {
                <span class="hljs-built_in">string</span> result = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">if</span> (doodleDrawInteraction?.DoodleStateManager != <span class="hljs-literal">null</span>)
                {
                    result = <span class="hljs-keyword">await</span> doodleDrawInteraction.DoodleStateManager.SaveCurrentState();
                    <span class="hljs-keyword">this</span>.OnSaveDoodleDraw?.Invoke(<span class="hljs-keyword">this</span>, result);
                }
                <span class="hljs-keyword">return</span> result;
            }
        }
    }
    </code></pre><!--!--><!--!--><p>Lastly, you need to register you export handler in the containers. This can be done when registering the Doodle Services</p><!--!--><pre><code class="language-cs hljs language-csharp">
      services.UseDoodle((config) =&gt; 
      {
          ...
      }, 
      saveHandler: () =&gt; <span class="hljs-keyword">new</span> MySaveHandler(),
      ...
    }
    </code></pre><!--!--><h3>Restoring Doodle</h3><!--!--><h4>Component Call</h4><!--!--><p>To restore a Doodle, a reference to the component is required and can be done as in the following example.</p><pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"height: 50vh;"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">DoodleDraw</span> @<span class="hljs-attr">ref</span>=<span class="hljs-string">"_doodleDraw"</span> &gt;</span>
        
    <span class="hljs-tag">&lt;/<span class="hljs-name">DoodleDraw</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><!--!--><pre><code class="language-cs hljs language-csharp">@code {

    <span class="hljs-keyword">private</span> DoodleDraw _doodleDraw;           
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">RestoreDoodle</span>(<span class="hljs-params"></span>)</span> 
    {
        <span class="hljs-keyword">await</span> _doodleDraw.RestoreCurrentDrawState(_jsonData);
    }
}
    </code></pre></div></div></div></div><div id="blazor-error-ui">An unhandled error has occurred. <a href="" class="reload">Reload</a> <a class="dismiss">ðŸ—™</a></div><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js"></script><script src="_framework/blazor.webassembly.js"></script><script>window.exportImage = (imgData) => {
            window.open().document.write('<img src="' + imgData + '" />');
        }
        window.higlightCode = () => {
            hljs.highlightAll();
        };</script></body></html>